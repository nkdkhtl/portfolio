name: Auto update repo metadata

on:
  push:
    branches: [main]

permissions:
  contents: write

jobs:
  update-about:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.CREATE_TOKEN_TOKEN }}
          script: |
            const languages = await github.rest.repos.listLanguages({
              owner: context.repo.owner,
              repo: context.repo.repo
            });

            const langs = Object.keys(languages.data);
            if (langs.length === 0) return;

            const topics = langs.map(lang => lang.toLowerCase());

            await github.rest.repos.update({
              owner: context.repo.owner,
              repo: context.repo.repo,
              description: `This is a portfolio repository showcasing various projects and skills.`,
              topics: topics
            });
